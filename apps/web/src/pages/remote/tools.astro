---
import Layout from '../../layouts/Layout.astro';
import RemoteToolsPage from '../../components/remote/RemoteToolsPage';
import { parseRemoteToolsParams } from '../../lib/remoteToolsParams';

const routeParams = parseRemoteToolsParams(Astro.url.searchParams);

if (!routeParams) {
  return Astro.redirect('/remote');
}

const { deviceId, deviceName, deviceOs } = routeParams;
---

<Layout title="Remote Tools | Breeze RMM">
  <div class="h-[calc(100vh-4rem)]">
    <RemoteToolsPage
      deviceId={deviceId}
      deviceName={deviceName}
      deviceOs={deviceOs}
      showClose={true}
      client:only="react"
    >
      <div slot="fallback" class="flex h-full items-center justify-center">
        <div class="text-center">
          <p class="text-muted-foreground">Loading Remote Tools...</p>
          <p class="mt-2 text-sm text-muted-foreground">
            Select a device to access remote management tools
          </p>
        </div>
      </div>
    </RemoteToolsPage>
  </div>
</Layout>
